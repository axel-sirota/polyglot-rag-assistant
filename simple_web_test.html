<!DOCTYPE html>
<html>
<head>
    <title>Voice Assistant - LiveKit Style</title>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        .container {
            text-align: center;
            padding: 2rem;
        }
        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .status {
            font-size: 1.2rem;
            margin: 2rem 0;
            color: #888;
        }
        .button {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 3px solid #667eea;
            background: transparent;
            color: #667eea;
            font-size: 4rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            margin: 2rem auto;
        }
        .button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
        }
        .button.active {
            animation: pulse 1.5s infinite;
            background: rgba(102, 126, 234, 0.2);
            border-color: #f5576c;
            color: #f5576c;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }
        .messages {
            margin: 2rem auto;
            max-width: 600px;
            text-align: left;
            max-height: 300px;
            overflow-y: auto;
        }
        .message {
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 12px;
            background: #1a1a1a;
        }
        .user { background: #1a1f2e; border-left: 3px solid #667eea; }
        .assistant { background: #1f1a2e; border-left: 3px solid #764ba2; }
        .instructions {
            margin-top: 3rem;
            font-size: 0.9rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé§ LiveKit Voice Demo</h1>
        <p class="status" id="status">Click the microphone to start</p>
        
        <button class="button" id="micButton">
            <span id="micIcon">üéôÔ∏è</span>
        </button>
        
        <div class="messages" id="messages"></div>
        
        <div class="instructions">
            <p>Try: "Find flights from New York to Paris tomorrow"</p>
            <p>Or speak in any language!</p>
        </div>
    </div>

    <script>
        const micButton = document.getElementById('micButton');
        const micIcon = document.getElementById('micIcon');
        const status = document.getElementById('status');
        const messages = document.getElementById('messages');
        
        let isRecording = false;
        let mediaRecorder;
        let audioChunks = [];
        
        // Add message to chat
        function addMessage(type, text) {
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.innerHTML = `<strong>${type === 'user' ? 'üë§ You' : 'ü§ñ Assistant'}:</strong> ${text}`;
            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
        }
        
        // Toggle recording
        micButton.addEventListener('click', async () => {
            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    audioChunks = [];
                    
                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = async () => {
                        status.textContent = 'Processing...';
                        
                        // For demo, simulate the flow
                        setTimeout(() => {
                            // Simulated transcription
                            const queries = [
                                "Find flights from New York to Paris tomorrow",
                                "Buscar vuelos de Buenos Aires a Madrid",
                                "ÊàëÊÉ≥ËÆ¢‰ªéÂåó‰∫¨Âà∞‰∏äÊµ∑ÁöÑÊú∫Á•®"
                            ];
                            const query = queries[Math.floor(Math.random() * queries.length)];
                            addMessage('user', query);
                            
                            // Simulated response
                            setTimeout(() => {
                                const responses = {
                                    "Find flights from New York to Paris tomorrow": "I found 3 flights from JFK to CDG tomorrow. United Airlines UA914 at $450 departing 10:30 AM, Air France AF007 at $520 departing 6:30 PM, and Delta DL264 at $480 departing 11:45 PM.",
                                    "Buscar vuelos de Buenos Aires a Madrid": "Encontr√© 3 vuelos de EZE a MAD. Iberia IB6856 por $850 saliendo a las 22:30, Air Europa UX042 por $780 saliendo a las 23:45, y Aerol√≠neas Argentinas AR1132 por $920 saliendo a las 21:00.",
                                    "ÊàëÊÉ≥ËÆ¢‰ªéÂåó‰∫¨Âà∞‰∏äÊµ∑ÁöÑÊú∫Á•®": "ÊàëÊâæÂà∞‰∫Ü3‰∏™‰ªéÂåó‰∫¨Âà∞‰∏äÊµ∑ÁöÑËà™Áè≠„ÄÇÂõΩËà™CA1831ÔºåÁ•®‰ª∑¬•680Ôºå‰∏äÂçà8:00Ëµ∑È£ûÔºõ‰∏úËà™MU5183ÔºåÁ•®‰ª∑¬•720Ôºå‰∏ãÂçà2:30Ëµ∑È£ûÔºõÂçóËà™CZ6162ÔºåÁ•®‰ª∑¬•650ÔºåÊôö‰∏ä6:00Ëµ∑È£û„ÄÇ"
                                };
                                addMessage('assistant', responses[query] || "I found several flight options for you.");
                                status.textContent = 'Ready - Click to speak again';
                                
                                // Play audio response (simulated)
                                const audio = new Audio();
                                audio.src = 'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLYiTYIG2m98OScTgwOUana6a1uFgU7k9n1unEiBC13yO/eizEIHWq+8+OWT' + 
                                        'QwRUqzf66VVEghHoeT0v3AeBilyyPDciTYIHWi58OScTwwOUKXf8bNpGAU2ktXztHYkBTF5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0ktXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0ktXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0ktXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0ktXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0kdXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0kdXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0kdXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0kdXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0kdXztHYkBTJ5yu7giTAIHGq+8eCcUgwRUqve7rJnGAU0';
                                // Play simulated beep
                                audio.play().catch(() => {});
                            }, 1500);
                        }, 1000);
                    };
                    
                    mediaRecorder.start();
                    isRecording = true;
                    micButton.classList.add('active');
                    micIcon.textContent = '‚èπÔ∏è';
                    status.textContent = 'Listening... Click to stop';
                    
                } catch (err) {
                    status.textContent = 'Error: ' + err.message;
                }
            } else {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
                isRecording = false;
                micButton.classList.remove('active');
                micIcon.textContent = 'üéôÔ∏è';
            }
        });
    </script>
</body>
</html>